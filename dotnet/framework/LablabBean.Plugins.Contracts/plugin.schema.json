{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://lablab-bean.dev/schemas/plugin.schema.json",
  "title": "Lablab Bean Plugin Manifest",
  "description": "Schema for plugin.json manifest files in Lablab Bean plugin system",
  "type": "object",
  "required": ["id", "name", "version", "entryPoint"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference (optional)"
    },
    "id": {
      "type": "string",
      "description": "Unique plugin identifier (lowercase, kebab-case recommended)",
      "pattern": "^[a-z0-9][a-z0-9-]*$",
      "minLength": 1,
      "maxLength": 50,
      "examples": ["inventory", "status-effects", "advanced-combat"]
    },
    "name": {
      "type": "string",
      "description": "Human-readable plugin display name",
      "minLength": 1,
      "maxLength": 100,
      "examples": ["Inventory System", "Status Effects Plugin"]
    },
    "version": {
      "type": "string",
      "description": "Plugin version (semantic versioning recommended)",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9.-]+)?$",
      "examples": ["1.0.0", "2.1.3-beta", "0.1.0-alpha.1"]
    },
    "description": {
      "type": "string",
      "description": "Brief description of plugin functionality",
      "maxLength": 500
    },
    "author": {
      "type": "string",
      "description": "Plugin author name or organization",
      "maxLength": 100,
      "examples": ["Lablab Bean Team", "John Doe <john@example.com>"]
    },
    "license": {
      "type": "string",
      "description": "SPDX license identifier or custom license",
      "examples": ["MIT", "Apache-2.0", "GPL-3.0", "Proprietary"]
    },
    "homepage": {
      "type": "string",
      "description": "Plugin homepage or documentation URL",
      "format": "uri",
      "examples": ["https://github.com/user/plugin"]
    },
    "repository": {
      "type": "string",
      "description": "Source repository URL",
      "format": "uri",
      "examples": ["https://github.com/user/plugin.git"]
    },
    "tags": {
      "type": "array",
      "description": "Searchable tags for plugin categorization",
      "items": {
        "type": "string",
        "minLength": 1,
        "maxLength": 30
      },
      "uniqueItems": true,
      "examples": [
        ["inventory", "items"],
        ["combat", "gameplay"]
      ]
    },
    "entryPoint": {
      "type": "object",
      "description": "Profile-specific entry points for multi-targeting",
      "properties": {
        "dotnet.console": {
          "type": "string",
          "description": "Entry point for Terminal.Gui console application",
          "pattern": "^[^,]+\\.dll,[a-zA-Z_][a-zA-Z0-9_.]+$",
          "examples": ["MyPlugin.dll,MyPlugin.PluginClass"]
        },
        "dotnet.sadconsole": {
          "type": "string",
          "description": "Entry point for SadConsole UI",
          "pattern": "^[^,]+\\.dll,[a-zA-Z_][a-zA-Z0-9_.]+$"
        },
        "unity": {
          "type": "string",
          "description": "Entry point for Unity game engine (future)",
          "pattern": "^[^,]+\\.dll,[a-zA-Z_][a-zA-Z0-9_.]+$"
        }
      },
      "additionalProperties": false,
      "minProperties": 1,
      "examples": [
        {
          "dotnet.console": "LablabBean.Plugins.Inventory.dll,LablabBean.Plugins.Inventory.InventoryPlugin"
        }
      ]
    },
    "dependencies": {
      "type": "array",
      "description": "Plugin dependencies (loaded before this plugin)",
      "items": {
        "type": "object",
        "required": ["id"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Dependency plugin ID",
            "pattern": "^[a-z0-9][a-z0-9-]*$"
          },
          "versionRange": {
            "type": "string",
            "description": "Semantic version range (default: *)",
            "default": "*",
            "examples": [
              "*",
              "1.0.0",
              ">=1.0.0",
              ">=1.0.0 <2.0.0",
              "^1.0.0",
              "~1.2.0"
            ]
          },
          "optional": {
            "type": "boolean",
            "description": "Allow missing dependency (default: false)",
            "default": false
          }
        },
        "additionalProperties": false
      },
      "default": []
    },
    "capabilities": {
      "type": "array",
      "description": "Plugin capabilities for discovery and filtering",
      "items": {
        "type": "string",
        "enum": [
          "gameplay",
          "ui",
          "rendering",
          "audio",
          "network",
          "persistence",
          "debug",
          "demo",
          "test",
          "framework",
          "logging",
          "inventory",
          "combat",
          "crafting",
          "terminal"
        ]
      },
      "uniqueItems": true,
      "default": [],
      "examples": [
        ["gameplay", "inventory"],
        ["ui", "rendering"]
      ]
    },
    "priority": {
      "type": "integer",
      "description": "Plugin load priority (higher = loaded later, default: 100)",
      "minimum": 0,
      "maximum": 2000,
      "default": 100,
      "examples": [100, 200, 1000]
    },
    "security": {
      "type": "object",
      "description": "Security configuration (future enhancement)",
      "properties": {
        "permissions": {
          "type": "array",
          "description": "Required permissions",
          "items": {
            "type": "string",
            "examples": [
              "FileSystem.Read",
              "FileSystem.Write",
              "Network.Connect",
              "Process.Execute"
            ]
          },
          "uniqueItems": true
        },
        "sandboxed": {
          "type": "boolean",
          "description": "Run in restricted sandbox",
          "default": false
        }
      },
      "additionalProperties": false
    },
    "metadata": {
      "type": "object",
      "description": "Custom metadata for plugin-specific configuration",
      "additionalProperties": true,
      "examples": [
        {
          "minGameVersion": "1.0.0",
          "maxPlayers": 4,
          "experimental": true
        }
      ]
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "id": "inventory",
      "name": "Inventory System",
      "version": "1.0.0",
      "description": "Provides inventory management for items and equipment",
      "author": "Lablab Bean Team",
      "license": "MIT",
      "entryPoint": {
        "dotnet.console": "LablabBean.Plugins.Inventory.dll,LablabBean.Plugins.Inventory.InventoryPlugin"
      },
      "dependencies": [],
      "capabilities": ["gameplay", "inventory"],
      "priority": 100
    },
    {
      "id": "advanced-combat",
      "name": "Advanced Combat System",
      "version": "2.0.0",
      "description": "Enhanced combat mechanics with combos and special moves",
      "author": "Combat Team",
      "entryPoint": {
        "dotnet.console": "CombatPlugin.dll,CombatPlugin.AdvancedCombatPlugin"
      },
      "dependencies": [
        {
          "id": "status-effects",
          "versionRange": ">=1.0.0 <2.0.0",
          "optional": false
        }
      ],
      "capabilities": ["gameplay", "combat"],
      "priority": 150
    }
  ]
}
